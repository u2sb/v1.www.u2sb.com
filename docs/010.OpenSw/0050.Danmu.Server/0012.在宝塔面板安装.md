---
title: 在宝塔面板安装
date: 2022-07-12 21:00:46
permalink: /pages/9300a8/
categories:
  - 开源项目
tags:
  - 开源项目
  - Danmu.Server
---

:::tip
宝塔面板实在是太复杂了，研究了两天没搞懂，只能搞个大概的教程，本文仅供参考。
:::

## 基础环境

- Ubuntu Server 20.04
- 宝塔 7.9.2

## 上传可执行文件

上传可执行文件到服务器，上传位置由你自己决定，确保自己能找到，我测试的时候直接上传压缩包，然后用宝塔面板解压没有反应，不知道是我这里的 bug 还是整个宝塔面板都有问题，建议不使用压缩包，直接拖整个文件夹上去。

上传文件后检查权限，确保有执行权限，貌似宝塔上传的文件默认权限就是 755，这一步大概率可以省略，不放心的话就再检查一遍。

同时还要注意一下文件所有者，这里记一下，后面会用到，我也不知道宝塔文件所有到底是谁，面板上看是 root，但是使用 `ls -lha` 命令查看，文件所有者是 www，如果有懂的朋友可以解释一下。

![宝塔面板权限](/assets/img/2022/20220712-宝塔面板权限.png)

## 修改配置文件

修改 `appsettings.json`

需要修改的部分主要有：

- `Kestrel.Endpoints.Http.Url`: 监听地址和端口，根据需要修改，如果只是在本机反代，无需修改，如果需要在其他机器上反代，可修改为 `http://0.0.0.0:5001`
- `WithOrigins`: 跨域配置，如无跨域限制需求，无需修改。
- `Admins`: 必须修改，配置管理员账户和密码，可配置多个。

## 守护进程

先安装 `supervisor`，在终端执行

```bash
sudo apt install supervisor
```

以上命令仅限 Ubuntu 20.04 和 Debian11，其他系统自己去想办法解决。

然后在宝塔的软件商店找到 `Supervisor管理器`，安装完成后配置

![配置守护进程](/assets/img/2022/20220712-配置守护进程.png)

注意，截图上的可执行文件路径是错的，别 TM 不思考直接照着抄，错的都看不出来，看教程就是要举一反三，参考教程，根据自己的实际情况做出调整。

只要状态是 `RUNNING` 就正常了，其他状态自行排查错误，直接去看子配置文件，配置文件才是能直接看出错误的地方。

## 反向代理

在宝塔面板上创建一个纯静态站点。

然后设置站点的反向代理。

![添加反向代理](/assets/img/2022/20220712-添加反向代理.png)

注意一下端口号，别跟个 SB 一样，自己改了配置文件里的端口号，这里还是写 5001，你改的什么就用什么。

不出意外的话到这里教程就完成了。
