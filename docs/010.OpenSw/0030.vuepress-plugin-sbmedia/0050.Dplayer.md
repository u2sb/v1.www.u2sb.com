---
title: Dplayer
date: 2022-01-24 14:17:12
categories:
  - 开源项目
tags:
  - 开源项目
  - vuepress-plugin-sbmedia
permalink: /pages/aad6e7/
---

## 介绍

可以插入 dplayer 标签。

## 使用和示例

### 参数

> 此部分请熟读 [DPlayer 文档](http://dplayer.js.org/)

`src` 传参，具体参数见 [DPlayer 文档](http://dplayer.js.org/)，示例见上方 DEMO。

其他参数，默认配置可省略，修改默认配置请看下节。

### 基本使用

<DPlayer :src="dplayer" />

```vue
<DPlayer :src="dplayer" />

<script>
export default {
  data() {
    return {
      dplayer: {
        video: {
          url: "/assets/video/s_720.mp4",
        },
      },
    };
  },
};
</script>
```

### 弹幕

<DPlayer :src="dplayerDan" />

```vue
<DPlayer :src="dplayerDan" />

<script>
export default {
  data() {
    return {
      dplayerDan: {
        video: {
          url: "/assets/video/s_720.mp4",
        },
        danmaku: {
          api: "https://danmu.u2sb.com/api/danmu/dplayer/",
          id: "视频id，建议使用uuid",
          addition: [
            "https://danmu.u2sb.com/api/danmu/dplayer/v3/bilibili?cid=73636868",
          ],
        },
      },
    };
  },
};
</script>
```

:::tip
弹幕使用了 [Danmu.Server](https://github.com/u2sb/Danmu.Server)
:::

### FLV 视频

以下几种情况会自动引入 `flv.js`

- `url` 以 `.flv` 结尾且 `type` 类型为 `undefined`
- `type` 值为 `flv`

<DPlayer :src="dplayerFlv" />

```vue
<DPlayer :src="dplayerFlv" />

<script>
export default {
  data() {
    return {
      dplayerFlv: {
        video: {
          url: "/assets/video/s_720.flv",
          type: "flv",
        },
        danmaku: {
          api: "https://danmu.u2sb.com/api/danmu/dplayer/",
          id: "C6CC6218F1FB8770",
          addition: [
            "https://danmu.u2sb.com/api/danmu/dplayer/v3/bilibili?cid=73636868",
          ],
        },
      },
    };
  },
};
</script>
```

### HLS 视频

以下几种情况会自动引入 `hls.js`

- `url` 以 `.m3u8` 结尾且 `type` 类型为 `undefined`
- `type` 值为 `hls` 或 `m3u8`

<DPlayer :src="dplayerHls" />

```vue
<DPlayer :src="dplayerHls" />

<script>
export default {
    return {
      dplayerHls: {
        video: {
          url: "/assets/video/dash/master.m3u8",
          type: 'hls',
        },
        danmaku:{
          api: "https://danmu.u2sb.com/api/danmu/dplayer/",
          id: "C6CC6218F1FB8770",
          addition: ["https://danmu.u2sb.com/api/danmu/dplayer/v3/bilibili?cid=73636868"]
        }
      }
    };
  }
};
</script>
```

### Dash

以下几种情况会自动引入 `dash.js`

- `type` 值为 `dash`

<DPlayer :src="dplayerDash" />

```vue
<DPlayer :src="dplayerDash" />

<script>
export default {
    return {
      dplayerDash: {
        video: {
          url: "/assets/video/dash/stream.mpd",
          type: "dash"
        },
        danmaku:{
          api: "https://danmu.u2sb.com/api/danmu/dplayer/",
          id: "C6CC6218F1FB8770",
          addition: ["https://danmu.u2sb.com/api/danmu/dplayer/v3/bilibili?cid=73636868"]
        }
      },
    };
  }
};
</script>
```

### ShakaDash

以下几种情况会自动引入 `shaka-player.js`

- `url` 以 `.mpd` 结尾且 `type` 类型为 `undefined`
- `type` 值为 `shaka` 或 `shakadash` 或 `shaka-dash`

<DPlayer :src="dplayerShakaDash" />

```vue
<DPlayer :src="dplayerShakaDash" />

<script>
export default {
    return {
      dplayerShakaDash: {
        video: {
          url: "/assets/video/dash/stream.mpd",
          type: "shakadash"
        },
        danmaku:{
          api: "https://danmu.u2sb.com/api/danmu/dplayer/",
          id: "C6CC6218F1FB8770",
          addition: ["https://danmu.u2sb.com/api/danmu/dplayer/v3/bilibili?cid=73636868"]
        }
      },
    };
  }
};
</script>
```

### customType

<DPlayer :src="dplayerCustomHls" />

```bash
npm install hls.js
```

```vue
<DPlayer :src="dplayerCustomHls" />

<script>
export default {
    return {
      dplayerCustomHls: {
        video: {
          url: "/assets/video/dash/master.m3u8",
          type: 'customHls',
          customType: {
            customHls: function (video, player) {
              import(/* webpackChunkName: "hls" */ "hls.js/dist/hls.min.js").then(({ default: Hls })=> {
                const hls = new Hls();
                hls.loadSource(video.src);
                hls.attachMedia(video);
                player.on("destroy", function () {
                  hls.destroy();
                });
              });
            },
          },
        },
        danmaku:{
          api: "https://danmu.u2sb.com/api/danmu/dplayer/",
          id: "C6CC6218F1FB8770",
          addition: ["https://danmu.u2sb.com/api/danmu/dplayer/v3/bilibili?cid=73636868"]
        }
      }
    };
  }
};
</script>
```

### MSE 支持

:::warning
插件中部分代码是由 Copilot 自动生成，未经严格测试，如发现问题请及时反馈。
:::

默认配置了几种受支持的类型 (不区分大小写)，其他类型请见上方 customType 示例

- `type: "hls"` 或 `type: "m3u8"`
- `type: "flv"`
- `type: "dash"`
- `type: "shakadash"` 或 `type: "shaka"` 或 `type: "shaka-dash"`
- `type: "webtorrent"`

当 `type` 类型为 `undefined` 时，以下结尾的链接会自动添加对应类型

- `.m3u8`
- `.flv`
- `.mpd`

## 配置

```js
module.exports = {
  plugins: {
    sbmedia: {
      dplayer: {
        src: {},
      },
    },
  },
};
```

或

```js
module.exports = {
  plugins: [
    [
      "sbmedia",
      {
        dplayer: {
          src: {},
        },
      },
    ],
  ],
};
```

`src`下为播放器默认配置，每个 `<DPlayer />` 标签下的设置会覆盖默认配置。

<script>
  export default {
    data() {
      return {
        dplayer: {
          video: {
            url: "/assets/video/s_720.mp4"
          },
        },
        dplayerDan: {
          video: {
            url: "/assets/video/s_720.mp4"
          },
          danmaku:{
            api: "https://danmu.u2sb.com/api/danmu/dplayer/",
            id: "C6CC6218F1FB8770",
            addition: ["https://danmu.u2sb.com/api/danmu/dplayer/v3/bilibili?cid=73636868"]
          }
        },
        dplayerFlv: {
          video: {
            url: "/assets/video/s_720.flv",
            type: "flv",
          },
          danmaku: {
            api: "https://danmu.u2sb.com/api/danmu/dplayer/",
            id: "C6CC6218F1FB8770",
            addition: [
              "https://danmu.u2sb.com/api/danmu/dplayer/v3/bilibili?cid=73636868",
            ],
          },
        },
        dplayerHls: {
          video: {
            url: "/assets/video/dash/master.m3u8",
            type: 'hls',
          },
          danmaku:{
            api: "https://danmu.u2sb.com/api/danmu/dplayer/",
            id: "C6CC6218F1FB8770",
            addition: ["https://danmu.u2sb.com/api/danmu/dplayer/v3/bilibili?cid=73636868"]
          }
        },
        dplayerDash: {
          video: {
            url: "/assets/video/dash/stream.mpd",
            type: "dash"
          },
          autoplay: false,
          danmaku:{
            api: "https://danmu.u2sb.com/api/danmu/dplayer/",
            id: "C6CC6218F1FB8770",
            addition: ["https://danmu.u2sb.com/api/danmu/dplayer/v3/bilibili?cid=73636868"]
          }
        },
        dplayerShakaDash: {
          video: {
            url: "/assets/video/dash/stream.mpd",
            type: "shakadash"
          },
          danmaku:{
            api: "https://danmu.u2sb.com/api/danmu/dplayer/",
            id: "C6CC6218F1FB8770",
            addition: ["https://danmu.u2sb.com/api/danmu/dplayer/v3/bilibili?cid=73636868"]
          }
        },
        dplayerCustomHls: {
          video: {
            url: "/assets/video/dash/master.m3u8",
            type: 'customHls',
            customType: {
              customHls: function (video, player) {
                import(/* webpackChunkName: "hls" */ "hls.js/dist/hls.min.js").then(({ default: Hls })=> {
                  const hls = new Hls();
                  hls.loadSource(video.src);
                  hls.attachMedia(video);
                  player.on("destroy", function () {
                    hls.destroy();
                  });
                });
              },
            },
          },
          danmaku:{
            api: "https://danmu.u2sb.com/api/danmu/dplayer/",
            id: "C6CC6218F1FB8770",
            addition: ["https://danmu.u2sb.com/api/danmu/dplayer/v3/bilibili?cid=73636868"]
          }
        }
      };
    }
  };
</script>
