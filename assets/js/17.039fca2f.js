(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{460:function(t,s,a){"use strict";a.r(s);var e=a(2),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"简介"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[t._v("#")]),t._v(" 简介")]),t._v(" "),a("p",[t._v("这是 MetingJS 的后端服务器，可以部署在自己的服务器上，也可以部署在阿里云函数计算上。")]),t._v(" "),a("h2",{attrs:{id:"编译"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编译"}},[t._v("#")]),t._v(" 编译")]),t._v(" "),a("p",[t._v("非二次开发不需要看这一部分，直接看后面的部署即可。"),a("br"),t._v("\n下载项目，使用 vs 打开，调整参数编译。")]),t._v(" "),a("h2",{attrs:{id:"安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[t._v("#")]),t._v(" 安装")]),t._v(" "),a("h3",{attrs:{id:"在阿里云函数计算-fc-上安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在阿里云函数计算-fc-上安装"}},[t._v("#")]),t._v(" 在阿里云函数计算 (FC) 上安装")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/u2sb/MetingJS.Server/releases",target:"_blank",rel:"noopener noreferrer"}},[t._v("下载"),a("OutboundLink")],1),t._v(" fc 版本，开通阿里云函数计算")]),t._v(" "),a("p",[a("code",[t._v("控制台")]),t._v("  ->  "),a("code",[t._v("函数计算")]),t._v("  ->  "),a("code",[t._v("新建函数")]),t._v("  ->  "),a("code",[t._v("HTTP函数")])]),t._v(" "),a("p",[t._v("默认不需要修改配置，直接上传 fc.zip")]),t._v(" "),a("p",[t._v("函数入口为： "),a("code",[t._v("MetingJS.Server.Fc::MetingJS.Server.Fc.FcRemoteEntrypoint::HandleRequest")])]),t._v(" "),a("p",[t._v("请求地址为 (Meting 填写下方地址) ：")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("https://xxxxxxxxxxxx.cn-shanghai.fc.aliyuncs.com/xxxx-xx-xx/proxy/MetingJS/GetMusic/api/music\n或\nhttps://xxxxxxxxxxxx.cn-shanghai.fc.aliyuncs.com/xxxx-xx-xx/proxy/MetingJS/GetMusic/api.php\n\n例如 https://xxxxxxxxxxxx.cn-shanghai.fc.aliyuncs.com/xxxx-xx-xx/proxy/MetingJS/GetMusic/api/music?server=Tencent&type=lrc&id=0008yfgO0dmovi\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br")])]),a("p",[a("img",{attrs:{src:"/assets/img/docs/metingjs.server-01.png",alt:""}})]),t._v(" "),a("p",[a("img",{attrs:{src:"/assets/img/docs/metingjs.server-02.png",alt:""}})]),t._v(" "),a("p",[a("img",{attrs:{src:"/assets/img/docs/metingjs.server-03.png",alt:""}})]),t._v(" "),a("h3",{attrs:{id:"在服务器-linux-上安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在服务器-linux-上安装"}},[t._v("#")]),t._v(" 在服务器 (Linux) 上安装")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/u2sb/MetingJS.Server/releases",target:"_blank",rel:"noopener noreferrer"}},[t._v("下载"),a("OutboundLink")],1),t._v(" Linux 版本，上传到服务器，解压，修改  "),a("code",[t._v("appsettings.yml")])]),t._v(" "),a("div",{staticClass:"language-yml appsettings.yml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("KestrelSettings")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Port")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5000")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5001")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("UnixSocketPath")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/tmp/metingJS.Server.sock"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("AllowedHosts")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"*"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("WithOrigins")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"*"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Url")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("DefaultServerProvider")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Tencent"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Replace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Url")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ws.stream.qqmusic.qq.com"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"dl.stream.qqmusic.qq.com"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("Pic")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br")])]),a("p",[t._v("配置项详情如下：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("配置项")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("类型")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("解释")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("KestrelSettings.Port")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("int[]")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("服务使用的端口号")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("KestrelSettings.UnixSocketPath")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("string[]")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("服务使用的 unix 域套接字")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("AllowedHosts")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("默认无需修改")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("WithOrigins")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("string[]")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("允许跨域列表，可用使用通配符  "),a("code",[t._v("*")])])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("Url")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("string")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("程序运行的网址，会在返回结果中体现，不懂可用不填，但会牺牲一点性能，填写示例： "),a("code",[t._v("https://x.sm9.top/api/music")]),t._v(" "),a("code",[t._v("https//sm.sm9.top:8080/api/music")])])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("Replace.Url")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("string[][]")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("返回结果中 url 项的替换，url 中前面的字符会被替换为后面的，不懂可用不填")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("Replace.Pic")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("string[][]")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("解释见 URL")])])])]),t._v(" "),a("p",[t._v("修改完配置后，运行测试，使用进程守护工具 (Supervisor 或 pm2 等) 守护进程，然后使用反向代理服务器 (caddy 或 nginx 等) 代理端口。")])])}),[],!1,null,null,null);s.default=n.exports}}]);